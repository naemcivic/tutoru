<% if @user.student? && current_user.student? == false%>
<%= javascript_include_tag "https://maps.googleapis.com/maps/api/js?key=#{ENV['google_maps_api_key']}&callback=initMap", async: true, defer: true %>
    <h1><%= "#{@user.name}'s Profile" %></h1>
    <div class="tutors-photo">
      <%= image_tag @user.profile.avatar.url(:thumb) if @user.profile.avatar? %>
    </div>
      <ul>
        <li>Tutor's name: <%= @user.name %></li>
        <li>Tutor's email: <%= @user.email %></li>
        <li>A trusted tutor since <%= @user.member_since %></li>
        <li>Area of expertise: <%= @user.profile.category %></li>
        <li>Availability: <%= @user.profile.display_availability %></li>
        <li>Qualification: <%= @user.profile.qualification %></li>
        <li>Location: <%= @user.profile.location %></li>
      </ul>

    <div id="show-map" data-latitude="<%= @user.profile.latitude %>" data-longitude="<%= @user.profile.longitude %>">

    </div>

    <h4>Make an appointment</h4>
      <%= form_for [@user, @appointment], :remote => true do |f| %>
        <div id="appointment_errors">
          <%= render :partial => 'appointment_form_errors' %>
        </div>

        <div class="field">
          <%= f.label :appointment_date %><br />
          <%= f.text_field :appointment_date %>
        </div>

        <div class="field">
           <%= f.hidden_field :tutor_id, :value => params[:id] %>
        </div>

        <div class="actions">
          <%= f.submit %>
        </div>
      <% end %>

    <div id="upvote">
      <%= link_to like_user_path(@user), class: "like", method: :put do %>
        <button type="button" id="like">
          Upvote
        </button>
        <%= pluralize(@user.get_upvotes.size,"upvote") %>
      <% end %>
    </div>

      <%= link_to unlike_user_path(@user) , class: "like", method: :put do %>
        <button type="button" id="downvote-button">
          Downvote
        </button>
        <%= pluralize(@user.get_downvotes.size,"downvote") %>
      <% end %>



<% else %>

  <div class="user-profile">
    <h1>My Profile</h1>
      <ul>
        <li>Name: <%=@user.name%></li>
        <li>Email: <%=@user.email %></li>
      <% if current_user.student? && current_user.id == @user.id %>
        <li>My availability: <%=@user.profile.display_availability%></li>
        <%= link_to 'edit availability', edit_user_profile_path(@user.profile.user_id, @user.profile.id) %></br>
      <% end %>
  <% if current_user.student? == false %>
  <h2>You have <%= pluralize(@user.student_appointments.count, 'appointment') %></h2>

    <% @user.student_appointments.each do |student_appointment| %>
    <% if student_appointment.valid? %>
      <li>Tutor name: <%= (User.find(student_appointment.tutor_id).name) %></li>
      <li>Appointment Date: <%= student_appointment.appointment_date%></li>
      <li>Subject: <%= User.find(student_appointment.tutor_id).profile.category%></li></br>
    <% end %>
    <% end %>
  <% else %>
  <h2>You have <%= pluralize(@user.tutor_appointments.count, 'appointment') %></h2>
      <% @user.tutor_appointments.each do |tutor_appointment| %>
      <li>Student Name: <%= (User.find(tutor_appointment.student_id).name) %></li>
      <li>Appointment Date: <%= tutor_appointment.appointment_date%></li></br>
    <% end %>
    <% end %>
      </ul>
  </div>
<% end %>
